---
title: "ACH et CAH pour activpro"
output: html_notebook
---
# Cr√©ation base pour ACM et CAH

```{r}
na_Adm10_id = baseline$nepp3[which(is.na(baseline$Adm10))]
na_Adm11_id = baseline$nepp3[which(is.na(baseline$Adm11))]
na_Adm12_id = baseline$nepp3[which(is.na(baseline$Adm12))]
na_Adm12a_id = baseline$nepp3[which(is.na(baseline$Adm12a))]
na_actproBl_id = unique(c(na_Adm10_id,na_Adm11_id,na_Adm12_id,na_Adm12a_id))
```

```{r}
actproBl = baseline[-which(baseline$nepp3 %in% na_actproBl_id),c(1,25,27,29,30,594,595) ]
```
```{r}
colnames(baseline)[1]
colnames(baseline)[25]
colnames(baseline)[27]
colnames(baseline)[29]
colnames(baseline)[30]
colnames(baseline)[594]
colnames(baseline)[595]
```


# ACM

```{r}
ACM_activpro = MCA(actproBl)
```

```{r}
ACM_activpro$
```

# CAH

```{r}
cah_activpro = HCPC(ACM_activpro,graph = FALSE)
```

```{r}
plot(cah_activpro, choice = "tree")
```
```{r}
plot(cah_activpro, choice = "3D.map")
```
```{r}
plot(cah_activpro, choice = "bar")
```
```{r}
plot(cah_activpro, choice = "map")
```
# Ajout dans la base

```{r}
actproBl$cah_activpro = cah_activpro$data.clust$clust
```

4 = retraite
1 = travail
2 = chomeur
3 = inactif

```{r}
for (k in 1:(dim(actproBl)[1])){
  if(actproBl$cah_activpro[k] == 1)
    actproBl$cah_activproName[k] = "T"
  else if(actproBl$cah_activpro[k] == 2)
    actproBl$cah_activproName[k] = "C"
  else if(actproBl$cah_activpro[k] == 3)
    actproBl$cah_activproName[k] = "I"
  else if(actproBl$cah_activpro[k] == 4)
    actproBl$cah_activproName[k] = "R"
}
```
```{r}
actproBl$cah_activproName = as.factor(actproBl$cah_activproName)
```

```{r}
colnames(actproBl)
```

```{r}
for(l in baseline$nepp3){
  if(l %in% na_actproBl_id)
    baseline$activproCAH[which(baseline$nepp3 == l)] = NA
  else
    baseline$activproCAH[which(baseline$nepp3 == l)] = actproBl$cah_activproName[which(actproBl$nepp3 == l)]
}
```

```{r}
baseline$activproCAH = as.factor(baseline$activproCAH)
```


```{r}
summary(actproBl$cah_activproName)
summary(baseline$activproCAH)
```


